<!--
    SGR BETA
    File: MAINCLIENT.XHTML | Last Major Update: 13.05.2015
    Developer: Kevin Raian
    IDINALOG REBORN © 2015
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:p="http://primefaces.org/ui" lang="pt_br"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
        <meta name="viewport" content="width=device-width, initial-scale=1"></meta>

        <title>SGR | Principal</title>

        <!-- Carrega Bootstrap e CSS Extra -->
        <link href="css/bootstrap.css" rel="stylesheet"></link>
        <link href="css/sgr.css" rel="stylesheet"></link>
        <link href="css/mainclient.css" rel="stylesheet"></link>
        <link href="css/font-awesome.min.css" rel="stylesheet"></link>
        <!-- Carrega JQuery -->
        <script src="js/jquery-2.1.3.js"></script>
        <!-- Carrega Plugins Avulsos -->		
        <script src="js/bootstrap.js"></script>

    </h:head>

    <h:body>

        <ui:include src="topo.xhtml" />
        <h:form id="frmPrincipal" rendered="#{funcionarioController.tela == 0}"  >
            <h:panelGrid width="100%" >


                <h:panelGrid  columns="1" width="100%" style="margin-left: 10px;margin-top: 5%;background-color: #F8F8F8;" >

                     <p:poll interval="30" listener="#{funcionarioController.recarregarMesas()}" update="mesas" />
                    <p:dataTable style="text-align: center" id="mesas" tableStyleClass="table table-striped" emptyMessage="Nenhuma mesa em aberto." var="mesas" value="#{funcionarioController.listaMesasAberto}">


                        <p:column headerText="Mesa">
                            <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{mesas.numero}" />
                        </p:column>
                        
                        <p:column headerText="Solicitação de Encerramento">
                            <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{mesas.frag}" />
                        </p:column>


                        <p:column headerText="Visualizar Itens">
                            <p:commandButton ajax="false" class="btn btn-default navbar-default" update="mesas" value="Visualizar" actionListener="#{funcionarioController.visualizarPedidos(mesas)}" />
                        </p:column>


                    </p:dataTable>


                </h:panelGrid>

            </h:panelGrid>

        </h:form>


        <h:form style="margin-top: 5%;margin-left: 3%" id="frmDetalhe" rendered="#{funcionarioController.tela == 1}">

            <h:panelGrid style="background-color: #F8F8F8" >
                <h:panelGrid border="0" columns="1" width="300px" style="text-align: left"   >

                    <p:commandButton class="btn btn-danger navbar-btn" style="margin-left: 5px;width: 150px" update=":frmPrincipal :frmDetalhe" ajax="false" value="Voltar" actionListener="#{funcionarioController.mudarTela(0)}" />
                </h:panelGrid>

                <h:panelGrid style="font-family: Arial;font-weight: bold;font-size: 17px" columns="4">
                    <h:outputText value="Produto"  />
                    <h:outputText value="Quantidade" style="margin-left: 210px" />
                    <h:outputText value="Status" style="margin-left: 280px" />
                    <h:outputText value="Preço" style="margin-left: 170px" />
                </h:panelGrid>   
                <br/>

                <c:forEach   items="#{funcionarioController.listaMovimento}" var="movimento" id="movimento" >
                    <h:panelGrid border="0" columns="7" cellspacing="10" cellpadding="10" style="text-align: right;font-size: 15px" rendered="#{funcionarioController.tela == 1}">  


                        <h:panelGrid border="0" columns="1" width="300px" style="text-align: left"   >
                            <h:outputText value="#{movimento.item}" style="size: 600px; width: 200px;"/>
                        </h:panelGrid>

                        <h:panelGrid border="0" columns="1" width="300px" style="text-align: left"   >
                            <h:outputText value="#{movimento.quantidade}" style="size: 600px; width: 200px;"/>
                        </h:panelGrid>

                        <h:panelGrid  width="120px" style="text-align: center">

                            <p:column  sortBy="#{movimento.itemStatus}" headerText="Status do Item">

                                
                                <p:outputPanel rendered="#{movimento.itemStatus.equals('Solicitado')}"  >
                                    <h:outputText style="color: red;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />
                                </p:outputPanel>

                                <p:outputPanel rendered="#{movimento.itemStatus.equals('Pronto')}" >
                                    <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                                </p:outputPanel>

                                <p:outputPanel rendered="#{movimento.itemStatus.equals('Entregue')}" >
                                    <h:outputText style="color: green;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                                </p:outputPanel>
                            </p:column>
                        </h:panelGrid>
                        <p:column >
                            <h:panelGrid  width="200px">
                                <h:outputText value="#{movimento.preco}" style="text-align: center"  >  
                                    <f:convertNumber locale="pt_BR" pattern="#,##0.00" maxFractionDigits="2" groupingUsed="true" maxIntegerDigits="14" type="currency" currencySymbol="R$" />
                                </h:outputText>
                            </h:panelGrid>
                        </p:column>

                    </h:panelGrid>

                </c:forEach>
                <h:panelGrid border="1" width="100%" style="text-align: right;font-size: 18px" >

                    <h:outputText  value=" TOTAL: R$ #{funcionarioController.valorTotal} " >
                        <f:convertNumber locale="pt_BR" pattern="#,##0.00" maxFractionDigits="2" groupingUsed="true" maxIntegerDigits="14"  />
                    </h:outputText>    
                </h:panelGrid>
                <h:panelGrid >
                    <p:commandButton class="btn btn-danger navbar-btn" style="margin-left: 5px;width: 150px" update=":frmPrincipal :frmDetalhe" ajax="false" value="Encerrar Conta" actionListener="#{funcionarioController.encerrarConta()}" />
                </h:panelGrid>
                   <p:messages  showDetail="true" autoUpdate="false" closable="true"  />
            </h:panelGrid>

        </h:form>

    </h:body>

</html>