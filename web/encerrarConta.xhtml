<!--
    SGR BETA
    File: MAINCLIENT.XHTML | Last Major Update: 13.05.2015
    Developer: Kevin Raian
    IDINALOG REBORN © 2015
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:p="http://primefaces.org/ui" lang="pt_br"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
 
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
        <meta name="viewport" content="width=device-width, initial-scale=1"></meta>

        <title>SGR | Principal</title>

        <!-- Carrega Bootstrap e CSS Extra -->
        <link href="css/bootstrap.css" rel="stylesheet"></link>
        <link href="css/sgr.css" rel="stylesheet"></link>
        <link href="css/mainclient.css" rel="stylesheet"></link>
        <link href="css/font-awesome.min.css" rel="stylesheet"></link>
        <!-- Carrega JQuery -->
        <script src="js/jquery-2.1.3.js"></script>
        <!-- Carrega Plugins Avulsos -->		
        <script src="js/bootstrap.js"></script>

    </h:head>

    <h:body>

        <ui:include src="topo.xhtml" />
        <h:form id="frmPrincipal" rendered="#{funcionarioController.tela == 0}"  >
            <h:panelGrid width="100%" >


                <h:panelGrid  columns="1" width="100%" style="margin-left: 10px;margin-top: 5%;background-color: #F8F8F8;" >

                    <p:poll interval="30" listener="#{funcionarioController.recarregarMesas()}" update="mesas" />
                    <p:dataTable style="text-align: center" id="mesas" tableStyleClass="table table-striped" emptyMessage="Nenhuma mesa em aberto." var="mesas" value="#{funcionarioController.listaMesasAberto}">


                        <p:column headerText="Mesa">
                            <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{mesas.numero}" />
                        </p:column>

                        <p:column headerText="Solicitação de Encerramento">
                            <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{mesas.frag}" />
                        </p:column>


                        <p:column headerText="Visualizar Itens">
                            <p:commandButton ajax="false" class="btn btn-default navbar-default" update="mesas" value="Visualizar" actionListener="#{funcionarioController.visualizarPedidos(mesas)}" />
                        </p:column>


                    </p:dataTable>


                </h:panelGrid>

            </h:panelGrid>

        </h:form>


        <h:form style="margin-top: 5%;margin-left: 3%" id="frmDetalhe" rendered="#{funcionarioController.tela == 1}">

            <h:panelGrid border="0" columns="1" width="300px" style="text-align: left"   >

                <p:commandButton class="btn btn-danger navbar-btn" style="margin-left: 5px;width: 150px" update=":frmPrincipal :frmDetalhe" ajax="false" value="Voltar" actionListener="#{funcionarioController.mudarTela(0)}" />
            </h:panelGrid>
            <h:panelGrid  id="cupom" style="background-color: #F8F8F8" >

                <h:panelGrid>
                    <h:outputText value="Restaurante GATOS 289 - Av, Moura de Sá - Nova Iguaçu" />
                    <h:outputText value="Telefone: 2334-8877" />
                    <p:separator/>
                    <h:outputText value="COMPROVANTE - Sem valor fiscal" />
                    <h:outputText value="Número: #{movimento.clienteCodigo}" />
                    ------------------------------------------------------------
                </h:panelGrid>

                <h:dataTable  style="background-color: white;width: 40%" var="movimento" value="#{funcionarioController.listaMovimento}" id="movimento">

                    <h:column  >
                        <f:facet  name="header">
                            <h:outputText style="margin-right: 200px" value="Produto"/>
                        </f:facet>
                        <h:outputText  value="#{movimento.item}"/>
                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <h:outputText style="margin-right: 220px;"  value="Quantidade"/>
                        </f:facet>
                        <h:outputText  value="#{movimento.quantidade}"/>
                    </h:column>


                    <h:column>
                        <f:facet name="header">
                            <h:outputText style="margin-right: 50px"  value="Status"/>
                        </f:facet>

                        <p:outputPanel rendered="#{movimento.itemStatus.equals('Solicitado')}"  >
                            <h:outputText style="color: red;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />
                        </p:outputPanel>

                        <p:outputPanel rendered="#{movimento.itemStatus.equals('Pronto')}" >
                            <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                        </p:outputPanel>

                        <p:outputPanel rendered="#{movimento.itemStatus.equals('Entregue')}" >
                            <h:outputText style="color: green;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                        </p:outputPanel>

                        <p:outputPanel rendered="#{movimento.itemStatus.equals('Cancelamento')}" >
                            <h:outputText style="color: #28a4c9;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                        </p:outputPanel>

                        <p:outputPanel rendered="#{movimento.itemStatus.equals('Cancelado')}" >
                            <h:outputText style="color: blue;background-color: #888;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                        </p:outputPanel>

                      <p:outputPanel rendered="#{movimento.itemStatus.equals('Em Preparo')}" >
                            <h:outputText style="color: violet;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                        </p:outputPanel>
                


                    </h:column>

                    <h:column>
                        <f:facet name="header">
                            <h:outputText  value="Preço"/>
                        </f:facet>
                        <h:outputText style="text-align: right;margin-right: 20px"  value="#{movimento.preco}">
                            <f:convertNumber pattern="#,##0.00" minFractionDigits="2"/>  
                        </h:outputText>
                    </h:column>


                </h:dataTable>


                <h:panelGrid border="1" width="100%" style="text-align: right;font-size: 18px" >

                    <h:outputText  value=" TOTAL: R$ #{funcionarioController.valorTotal} " >
                        <f:convertNumber locale="pt_BR" pattern="#,##0.00" maxFractionDigits="2" groupingUsed="true" maxIntegerDigits="14"  />
                    </h:outputText>    
                </h:panelGrid>
                <ui:insert name="cupom" />  
            </h:panelGrid>


            <h:panelGrid columns="2" >
                <p:commandButton class="btn btn-danger navbar-btn" style="margin-left: 5px;width: 150px" update=":frmPrincipal :frmDetalhe" ajax="false" value="Encerrar Conta" actionListener="#{funcionarioController.encerrarConta()}" />

                <p:commandButton class="btn btn-success navbar-btn" ajax="false" value="Imprimir" >
                    <p:printer target="cupom" />
                </p:commandButton>

            </h:panelGrid>
            <p:messages  showDetail="true" autoUpdate="false" closable="true"  />


        </h:form>

    </h:body>

</html>