<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"

      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
        <title> Sistema de GestÃ£o Restaurante</title>

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
        <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
        <!-- Carrega Bootstrap e CSS Extra -->
        <link href="css/bootstrap.css" rel="stylesheet"></link>
        <link href="css/sgr.css" rel="stylesheet"></link>
        <link href="css/font-awesome.min.css" rel="stylesheet"></link>
        <script src="js/jquery-2.1.3.js"></script>		
        <script src="js/bootstrap.js"></script>


    </h:head>
    <body>
        <ui:include src="topo.xhtml" />
        <h:form id="frmPrincipal" rendered="#{funcionarioController.tela == 0}"  >
            <h:panelGrid width="100%" >
                <p:poll interval="30" listener="#{funcionarioController.recarregarMesas()}" update="movimento" />

                <h:panelGrid  columns="1" width="40%" style="margin-left: 10px;margin-top: 5%;background-color: #F8F8F8;" >

                    <h:panelGrid columns="1" cellpadding="5" cellspacing="5"  >
                        
                        <p:commandButton class="btn btn-default navbar-btn" style="margin-left: 20px;width: 250px"  value="Cadastro de Clientes" ajax="false" actionListener="#{funcionarioController.navegarPara('/manterCliente.jsf')}" />
                    </h:panelGrid>
                    <br/>

                    <p:dataTable id="movimento" style="text-align: center"  tableStyleClass="table table-striped" emptyMessage="Nenhuma mesa em aberto." var="mesas" value="#{funcionarioController.listaMesasAberto}">


                        <p:column headerText="Mesa">
                            <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{mesas.numero}" />
                        </p:column>

                        <p:column headerText="Visualizar Itens">
                            <p:commandButton ajax="false" class="btn btn-default navbar-default" update="mesas" value="Visualizar" actionListener="#{funcionarioController.visualizarPedidos(mesas)}" />
                        </p:column>


                    </p:dataTable>


                </h:panelGrid>

            </h:panelGrid>

        </h:form>

        <h:form rendered="#{funcionarioController.tela == 1}" id="frmDetalhe">
            <h:panelGrid width="100%" style="margin-left: 10px;margin-top: 5%;background-color: #F8F8F8;" >

                <h:panelGrid columns="5" cellpadding="5" cellspacing="5" style="text-align: center" >
                    <h:outputText style="font-weight: bold" value="Buscar por nome: " />
                    <p:inputText style="margin-left: 10px" value="#{funcionarioController.filtroPedido}" />
                  
                    <p:commandButton class="btn btn-default navbar-default" style="margin-left: 10px" update="movimento" value="Listar todos os pedidos" actionListener="#{funcionarioController.carregarPedidos()}" />
                    <p:commandButton class="btn btn-danger navbar-btn" style="margin-left: 50%;width: 150px" update=":frmPrincipal :frmDetalhe" ajax="false" value="Voltar" actionListener="#{funcionarioController.mudarTela(0)}" />
                </h:panelGrid>





                <br/>
                <p:messages  showDetail="true" autoUpdate="false" closable="true"  />
                <br/>
             
                <p:poll interval="30" listener="#{funcionarioController.listarItensProntosESolicitados()}" update="movimento" />
                
                <p:dataTable   paginator="true" rowsPerPageTemplate="5,10,15" rows="10" style="text-align: center" id="movimento" tableStyleClass="table table-striped" emptyMessage="Nenhuma pedido encontrado." var="movimento" value="#{funcionarioController.listaMovimento}">


                    <p:column headerText="Mesa">
                        <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{movimento.mesaNumero}" />
                    </p:column>

                    <p:column headerText="Cliente">
                        <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{movimento.clienteNome}" />
                    </p:column>

                    <p:column headerText="Item">
                        <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{movimento.item}" />
                    </p:column>



                    <p:column headerText="Quantidade">
                        <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{movimento.quantidade}" />
                    </p:column>


                    <p:column headerText="PreÃ§o">
                        <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{movimento.preco}" >
                            <f:convertNumber locale="pt_BR" pattern="#,##0.00" maxFractionDigits="2" groupingUsed="true" maxIntegerDigits="14" type="currency" currencySymbol="R$" />
                        </h:outputText>    
                    </p:column>


                    <p:column  sortBy="#{movimento.itemStatus}" headerText="Status do Item">

                        <p:outputPanel rendered="#{movimento.itemStatus.equals('Solicitado')}"  >
                            <h:outputText style="color: red;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />
                        </p:outputPanel>

                        <p:outputPanel rendered="#{movimento.itemStatus.equals('Pronto')}" >
                            <h:outputText style="color: blue;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                        </p:outputPanel>

                        <p:outputPanel rendered="#{movimento.itemStatus.equals('Entregue')}" >
                            <h:outputText style="color: green;font-weight: bold;font-size: 17px" value="#{movimento.itemStatus}" />  
                        </p:outputPanel>
                    </p:column>

                    <p:column headerText="Alterar status">
                        <p:commandButton ajax="false"  update="movimento" value="Entregue" actionListener="#{funcionarioController.alterarStatusItemEntregue(movimento)}" />
                    </p:column>

                </p:dataTable>

            </h:panelGrid>



        </h:form>    

    </body>

</html>